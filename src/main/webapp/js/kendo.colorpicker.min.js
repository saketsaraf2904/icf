/*
* Kendo UI Beta v2012.3.1322 (http://kendoui.com)
* Copyright 2013 Telerik AD. All rights reserved.
*
* Kendo UI Beta license terms available at
* http://www.kendoui.com/purchase/license-agreement/kendo-ui-beta.aspx
*/

("function"==typeof define&&define.amd?define:function(e,t){return t()})(["./kendo.core.min","./kendo.popup.min","./kendo.slider.min"],function(){(function(e,t,n){function s(e,t){var n,s;if(e.map)return e.map(t);for(n=[],s=0;e.length>s;++s)n[s]=t(e[s]);return n}function i(e,t,n){for(n||(n="0"),e=e.toString(16);t>e.length;)e="0"+e;return e}function a(e){return parseFloat((+e).toFixed(3))}function o(e,s){if(null==e||"transparent"==e)return null;if(e instanceof E)return e;var i=/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(e);if(i)return new T(t(i[1],16),t(i[2],16),t(i[3],16),1);if(i=/^#?([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e))return new T(t(i[1]+i[1],16),t(i[2]+i[2],16),t(i[3]+i[3],16),1);if(i=/^rgb\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/.exec(e))return new T(t(i[1],10),t(i[2],10),t(i[3],10),1);if(i=/^rgba\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9.]+)\s*\)/.exec(e))return new T(t(i[1],10),t(i[2],10),t(i[3],10),parseFloat(i[4]));if(i=/^rgb\(\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9]*\.?[0-9]+)%\s*\)/.exec(e))return new B(parseFloat(i[1])/100,parseFloat(i[2])/100,parseFloat(i[3])/100,1);if(i=/^rgba\(\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9.]+)\s*\)/.exec(e))return new B(parseFloat(i[1])/100,parseFloat(i[2])/100,parseFloat(i[3])/100,parseFloat(i[4]));if(!s)throw Error("Cannot parse color: "+e);return n}function r(e,t,n){var s,i;return e=Array.prototype.slice.call(e),s=e.length,i=e.indexOf(t),0>i?0>n?e[s-1]:e[0]:(i+=n,0>i?i+=s:i%=s,e[i])}function l(e){e.preventDefault()}function c(e,t){return function(){return e.apply(t,arguments)}}var u=window.kendo,d=u.Class,p=u.ui,C=p.Widget,h=u.keys,F="background-color",f="unselectable",v="k-state-selected",k="000000,7f7f7f,880015,ed1c24,ff7f27,fff200,22b14c,00a2e8,3f48cc,a349a4,ffffff,c3c3c3,b97a57,ffaec9,ffc90e,efe4b0,b5e61d,99d9ea,7092be,c8bfe7",_="FFFFFF,FFCCFF,FF99FF,FF66FF,FF33FF,FF00FF,CCFFFF,CCCCFF,CC99FF,CC66FF,CC33FF,CC00FF,99FFFF,99CCFF,9999FF,9966FF,9933FF,9900FF,FFFFCC,FFCCCC,FF99CC,FF66CC,FF33CC,FF00CC,CCFFCC,CCCCCC,CC99CC,CC66CC,CC33CC,CC00CC,99FFCC,99CCCC,9999CC,9966CC,9933CC,9900CC,FFFF99,FFCC99,FF9999,FF6699,FF3399,FF0099,CCFF99,CCCC99,CC9999,CC6699,CC3399,CC0099,99FF99,99CC99,999999,996699,993399,990099,FFFF66,FFCC66,FF9966,FF6666,FF3366,FF0066,CCFF66,CCCC66,CC9966,CC6666,CC3366,CC0066,99FF66,99CC66,999966,996666,993366,990066,FFFF33,FFCC33,FF9933,FF6633,FF3333,FF0033,CCFF33,CCCC33,CC9933,CC6633,CC3333,CC0033,99FF33,99CC33,999933,996633,993333,990033,FFFF00,FFCC00,FF9900,FF6600,FF3300,FF0000,CCFF00,CCCC00,CC9900,CC6600,CC3300,CC0000,99FF00,99CC00,999900,996600,993300,990000,66FFFF,66CCFF,6699FF,6666FF,6633FF,6600FF,33FFFF,33CCFF,3399FF,3366FF,3333FF,3300FF,00FFFF,00CCFF,0099FF,0066FF,0033FF,0000FF,66FFCC,66CCCC,6699CC,6666CC,6633CC,6600CC,33FFCC,33CCCC,3399CC,3366CC,3333CC,3300CC,00FFCC,00CCCC,0099CC,0066CC,0033CC,0000CC,66FF99,66CC99,669999,666699,663399,660099,33FF99,33CC99,339999,336699,333399,330099,00FF99,00CC99,009999,006699,003399,000099,66FF66,66CC66,669966,666666,663366,660066,33FF66,33CC66,339966,336666,333366,330066,00FF66,00CC66,009966,006666,003366,000066,66FF33,66CC33,669933,666633,663333,660033,33FF33,33CC33,339933,336633,333333,330033,00FF33,00CC33,009933,006633,003333,000033,66FF00,66CC00,669900,666600,663300,660000,33FF00,33CC00,339900,336600,333300,330000,00FF00,00CC00,009900,006600,003300,000000",g={apply:"Apply",cancel:"Cancel"},b=".kendoColorTools",y="click"+b,m="mousedown"+b,w="keydown"+b,S=u.support.browser,x=S.msie&&9>t(S.version,10),I=C.extend({init:function(e,t){var n,s=this;C.fn.init.call(s,e,t),e=s.element,t=s.options,s._value=t.value=o(t.value),n=s._ariaId=t.ariaId,n&&e.attr("aria-labelledby",n)},options:{value:null},events:["change","select","cancel"],color:function(e){return e!==n&&this._updateUI(this._value=o(e)),this._value},value:function(e){return e=this.color(e),e?this.options.opacity?e.toCssRgba():e.toCss():null},enable:function(t){0===arguments.length&&(t=!0),t?e(".k-disabled-overlay",this.wrapper).remove():this.wrapper.append("<div class='k-disabled-overlay'></div>"),this._onEnable(t)},_select:function(e,t){e=this.color(e),t||this.trigger("change")},destroy:function(){this.element.off(b),this.wrapper.off(b).find("*").off(b),this.wrapper=null,C.fn.destroy.call(this)},_updateUI:e.noop,_selectOnHide:function(){return null},_cancel:function(){this.trigger("cancel")}}),H=I.extend({init:function(t,n){var i,a,r=this;I.fn.init.call(r,t,n),t=r.wrapper=r.element,n=r.options,i=n.palette,"websafe"==i?(i=_,n.columns=18):"basic"==i&&(i=k),"string"==typeof i&&(i=i.split(",")),e.isArray(i)&&(i=s(i,o)),t.addClass("k-colorpicker-popup").append(e(r._template({colors:i,size:n.size,value:r._value,id:n.ariaId}))).on(y,".k-item",function(t){r._select(e(t.currentTarget).find("div").css(F))}).find("*").attr(f,"on").end().attr("tabIndex",0).on(w,c(r._keydown,r)),a=n.size,a&&(a+="px",t.find(".k-item").css({width:a,height:a})),n.columns&&t.css("width",n.columns*(n.size||14)+"px")},focus:function(){this.wrapper.focus()},options:{name:"ColorPalette",columns:10,size:null,palette:"basic"},_onEnable:function(e){e?this.wrapper.removeAttr("tabIndex"):this.wrapper.attr("tabIndex",0)},_keydown:function(t){var n,s,i=this,a=i.wrapper,c=a.find(".k-item"),u=a.find(".k-item."+v).get(0);switch(t.keyCode){case h.LEFT:l(t),n=r(c,u,-1);break;case h.RIGHT:l(t),n=r(c,u,1);break;case h.DOWN:l(t),n=r(c,u,i.options.columns);break;case h.UP:l(t),n=r(c,u,-i.options.columns);break;case h.ENTER:l(t),u&&this._select(e("div",u).css(F));break;case h.ESC:this._cancel()}if(n){n=e(n),e(u).removeClass(v).removeAttr("aria-selected"),n.addClass(v).attr("aria-selected",!0);try{s=o(n.find("div").css(F)),s.equals(i.color())||i.trigger("select",{value:s})}catch(d){}}},_updateUI:function(t){var n,s,i,a=this;a.wrapper.find(".k-item."+v).removeClass(v).removeAttr("aria-selected"),n=null,s=null,i=null,a.wrapper.find(".k-item div").each(function(){var a,r=o(e(this).css(F));r&&(r.equals(t)?n=this.parentNode:(a=r.diff(t),(null==i||i>a)&&(i=a,s=this.parentNode)))}),n||(n=s),n&&e(n).addClass(v).attr("aria-selected",!0)},_template:u.template('<ul class="k-palette k-reset"># for (var i = 0; i < colors.length; i++) { #<li #=(id && i === 0) ? "id=\\""+id+"\\" aria-selected=\\"true\\"" : "" # class="k-item #= colors[i].equals(value) ? "'+v+'" : "" #" aria-label="#= colors[i].toCss() #">'+'<div style="background-color:#= colors[i].toCss() #"></div>'+"</li>"+"# } #"+"</ul>")}),R=I.extend({init:function(t,n){var s,i,a,r,u,d,p=this;I.fn.init.call(p,t,n),n=p.options,t=p.element,p.wrapper=t.addClass("k-flatcolorpicker").append(p._template(n)).find("*").attr(f,"on").end(),s=p._hueSlider=e(".k-hue-slider",t).kendoSlider({min:0,max:359,tickPlacement:"none",showButtons:!1}).data("kendoSlider"),x&&(i=e(".k-hue-slider .k-slider-track",t)[0],a=i.currentStyle.backgroundImage,a=a.replace(/^url\([\'\"]?|[\'\"]?\)$/g,""),i.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a+"', sizingMethod='scale')"),r=p._opacitySlider=e(".k-transparency-slider",t).kendoSlider({min:0,max:100,tickPlacement:"none",showButtons:!1}).data("kendoSlider"),u=p._hsvRect=e(".k-hsv-rectangle",t),d=p._hsvHandle=e(".k-draghandle",u).attr("tabIndex",0).on(w,c(p._keydown,p)),p._hueElements=e(".k-hsv-rectangle, .k-transparency-slider .k-slider-track",t),p._selectedColor=e(".k-selected-color-display",t),p._colorAsText=e("input.k-color-value",t),s.bind(["slide","change"],function(e){p._updateUI(p._getHSV(e.value,null,null,null))}),r&&r.bind(["slide","change"],function(e){p._updateUI(p._getHSV(null,null,null,e.value/100))}),p._updateUI(p._value||new B(1,0,0,1)),u.on(m,function(t){function n(e){var t=e.pageX,n=e.pageY,s=t-i.left,r=n-i.top;0>s&&(s=0),s>a&&(s=a),0>r&&(r=0),r>o&&(r=o),d.css({left:s+"px",top:r+"px"}),p._svChange(s/a,1-r/o),l(e)}function s(t){e(document).unbind("mousemove",n).unbind("mouseup",s),l(t),u.removeClass("k-dragging")}var i,a,o;u.addClass("k-dragging"),d.focus(),i=u.offset(),a=u.width(),o=u.height(),n(t),e(document).mousemove(n).mouseup(s)}),t.find("input.k-color-value").on(w,function(t){var n,s;if(t.keyCode==h.ENTER)try{n=o(this.value),s=p.color(),e(this).removeClass("k-state-error"),p._select(n,!n.equals(s))}catch(i){e(this).addClass("k-state-error")}}).end().on(y,".k-controls button.apply",function(){p._select(p._getHSV())}).on(y,".k-controls button.cancel",function(){p._updateUI(p.color()),p._cancel()})},destroy:function(){this._hueSlider.destroy(),this._opacitySlider&&this._opacitySlider.destroy(),this._hueSlider=this._opacitySlider=this._hsvRect=this._hsvHandle=this._hueElements=this._selectedColor=this._colorAsText=null,I.fn.destroy.call(this)},options:{name:"FlatColorPicker",opacity:!1,buttons:!0,input:!0,preview:!0,messages:g},_onEnable:function(t){this._hueSlider.enable(t),this._opacitySlider&&this._opacitySlider.enable(t),e("input",this.wrapper).attr("disabled",!t);var n=e(".k-draghandle",this._hsvRect);t?n.attr("tabIndex",0):n.removeAttr("tabIndex")},_keydown:function(e){function t(t,n){var i=s._getHSV();i[t]+=n*(e.shiftKey?.01:.05),0>i[t]&&(i[t]=0),i[t]>1&&(i[t]=1),s._updateUI(i),l(e)}function n(t){var n=s._getHSV();n.h+=t*(e.shiftKey?1:5),0>n.h&&(n.h=0),n.h>359&&(n.h=359),s._updateUI(n),l(e)}var s=this;switch(e.keyCode){case h.LEFT:e.ctrlKey?n(-1):t("s",-1);break;case h.RIGHT:e.ctrlKey?n(1):t("s",1);break;case h.UP:t(e.ctrlKey&&s._opacitySlider?"a":"v",1);break;case h.DOWN:t(e.ctrlKey&&s._opacitySlider?"a":"v",-1);break;case h.ENTER:s._select(s._getHSV());break;case h.F2:s.wrapper.find("input.k-color-value").focus().select();break;case h.ESC:s._cancel()}},focus:function(){this._hsvHandle.focus()},_getHSV:function(e,t,n,s){var i=this._hsvHandle,a=this._hsvRect,o=a.width(),r=a.height(),l=i.position();return null==e&&(e=this._hueSlider.value()),null==t&&(t=l.left/o),null==n&&(n=1-l.top/r),null==s&&(s=this._opacitySlider?this._opacitySlider.value()/100:1),new U(e,t,n,s)},_svChange:function(e,t){var n=this._getHSV(null,e,t,null);this._updateUI(n)},_updateUI:function(e){var t,n,s,i,a=this;e&&(a._selectedColor.css(F,e.toDisplay()),a._colorAsText.val(a._opacitySlider?e.toCssRgba():e.toCss()),e.equals(a.color())||a.trigger("select",{value:e}),e=e.toHSV(),t=a._hsvHandle,n=a._hsvRect,s=n.width(),i=n.height(),t.css({left:e.s*s+"px",top:(1-e.v)*i+"px"}),a._hueElements.css(F,new U(e.h,1,1,1).toCss()),a._hueSlider.value(e.h),a._opacitySlider&&a._opacitySlider.value(100*e.a))},_selectOnHide:function(){return this.options.buttons?null:this._getHSV()},_template:u.template('# if (preview) { #<div class="k-selected-color"><div class="k-selected-color-display"><input spellcheck="false" class="k-color-value" #= !data.input ? \'style="visibility: hidden;"\' : "" #></div></div># } #<div class="k-hsv-rectangle"><div class="k-hsv-gradient"></div><div class="k-draghandle"></div></div><input class="k-hue-slider" /># if (opacity) { #<input class="k-transparency-slider" /># } ## if (buttons) { #<div class="k-controls"><button class="k-button apply">#: messages.apply #</button> <button class="k-button cancel">#: messages.cancel #</button></div># } #')}),E=d.extend({toHSV:function(){return this},toRGB:function(){return this},toHex:function(){return this.toBytes().toHex()},toBytes:function(){return this},toCss:function(){return"#"+this.toHex()},toCssRgba:function(){var e=this.toBytes();return"rgba("+e.r+", "+e.g+", "+e.b+", "+a(this.a)+")"},toDisplay:function(){return x?this.toCss():this.toCssRgba()},equals:function(e){return e===this||null!==e&&this.toHex()==o(e).toHex()},diff:function(e){if(null==e)return 0/0;var t=this.toBytes();return e=e.toBytes(),Math.sqrt(Math.pow(.3*(t.r-e.r),2)+Math.pow(.59*(t.g-e.g),2)+Math.pow(.11*(t.b-e.b),2))},clone:function(){var e=this.toBytes();return e===this&&(e=new T(e.r,e.g,e.b,e.a)),e}}),B=E.extend({init:function(e,t,n,s){this.r=e,this.g=t,this.b=n,this.a=s},toHSV:function(){var e,t,n=this.r,s=this.g,i=this.b,a=Math.min(n,s,i),o=Math.max(n,s,i),r=o,l=o-a;return 0!==o?(t=l/o,e=n==o?(s-i)/l:s==o?2+(i-n)/l:4+(n-s)/l,e*=60,0>e&&(e+=360)):(t=0,e=-1),new U(e,t,r,this.a)},toBytes:function(){return new T(255*this.r,255*this.g,255*this.b,this.a)}}),T=B.extend({init:function(e,t,n,s){this.r=Math.round(e),this.g=Math.round(t),this.b=Math.round(n),this.a=s},toRGB:function(){return new B(this.r/255,this.g/255,this.b/255,this.a)},toHSV:function(){return this.toRGB().toHSV()},toHex:function(){return i(this.r,2)+i(this.g,2)+i(this.b,2)},toBytes:function(){return this}}),U=E.extend({init:function(e,t,n,s){this.h=e,this.s=t,this.v=n,this.a=s},toRGB:function(){var e,t,n,s,i,a,o,r,l=this.h,c=this.s,u=this.v;if(0===c)t=n=s=u;else switch(l/=60,e=Math.floor(l),i=l-e,a=u*(1-c),o=u*(1-c*i),r=u*(1-c*(1-i)),e){case 0:t=u,n=r,s=a;break;case 1:t=o,n=u,s=a;break;case 2:t=a,n=u,s=r;break;case 3:t=a,n=o,s=u;break;case 4:t=r,n=a,s=u;break;default:t=u,n=a,s=o}return new B(t,n,s,this.a)},toBytes:function(){return this.toRGB().toBytes()}}),P=C.extend({init:function(t,n){var s,i,a,r=this;C.fn.init.call(r,t,n),n=r.options,t=r.element,s=t.val()?o(t.val(),!0):o(n.value,!0),r._value=n.value=s,i=r.wrapper=e(r._template(n)),t.hide().after(i),r.enable(!t.attr("disabled")),a=t.attr("accesskey"),a&&(t.attr("accesskey",null),i.attr("accesskey",a)),r.bind("activate",function(e){e.isDefaultPrevented()||r.toggle()}),r._updateUI(s)},destroy:function(){this.wrapper.add("*").off(b),this._popup&&(this._selector.destroy(),this._popup.destroy()),this._selector=this._popup=this.wrapper=null,C.fn.destroy.call(this)},enable:function(e){0===arguments.length&&(e=!0);var t=this,n=t.wrapper;t.element.attr("disabled",!e),n.attr("disabled",!e),e?n.removeClass("k-state-disabled").attr("tabIndex",0).on("mouseenter"+b,function(){n.children(".k-picker-wrap").addClass("k-state-hover")}).on("mouseleave"+b,function(){n.children(".k-picker-wrap").removeClass("k-state-hover")}).on(w,c(t._keydown,t)).on(m,".k-icon",c(t.toggle,t)).on(y,t.options.toolIcon?".k-tool-icon":".k-selected-color",function(){t.trigger("activate")}):n.addClass("k-state-disabled").removeAttr("tabIndex").add("*",n).off(b)},_template:u.template('<span class="k-widget k-colorpicker k-header"><span class="k-picker-wrap"># if (toolIcon) { #<span class="k-tool-icon #= toolIcon #"><span class="k-selected-color"></span></span># } else { #<span class="k-selected-color"></span># } #<span class="k-select"><span class="k-icon k-i-arrow-s"></span></span></span></span>'),options:{name:"ColorPicker",palette:null,columns:10,toolIcon:null,value:null,messages:g,opacity:!1,buttons:!0,preview:!0},events:["activate","change","select","open","close"],open:function(){this._getPopup().open()},close:function(){this._getPopup().close()},toggle:function(){this._getPopup().toggle()},_select:function(e){e=this.color(e),this.trigger("change")},color:I.fn.color,value:I.fn.value,_isInputTypeColor:function(){var e=this.element[0];return/^input$/i.test(e.tagName)&&/^color$/i.test(e.type)},_updateUI:function(e){e&&(this._isInputTypeColor()||1==e.a?this.element.val(e.toCss()):this.element.val(e.toCssRgba())),e&&!e.equals(this.color())&&this.trigger("select",{value:e}),this.wrapper.find(".k-selected-color").css(F,e?e.toDisplay():"transparent")},_keydown:function(e){var t=e.keyCode;this._getPopup().visible()?(t==h.ESC?this._selector._cancel():this._selector._keydown(e),l(e)):(t==h.ENTER||t==h.DOWN)&&(this.open(),l(e))},_getPopup:function(){var t,s,i,a=this,o=a._popup;return o||(t=this.options,s=t.palette?H:R,i=this._selector=new s(e("<div></div>").appendTo(document.body),t),a._popup=o=i.wrapper.kendoPopup({anchor:a.wrapper}).data("kendoPopup"),i.bind({select:function(e){a._updateUI(e.value)},change:function(){a._select(i.color()),a.close()},cancel:function(){a.close()}}),o.bind({close:function(e){if(a.trigger("close"))return e.preventDefault(),n;var t=i._selectOnHide();t?a._select(t):(a.wrapper.focus(),a._updateUI(a.color()))},open:function(e){a.trigger("open")&&e.preventDefault()},activate:function(){i._select(a.color(),!0),i.focus()}})),o}});p.plugin(H),p.plugin(R),p.plugin(P),u.parseColor=o,u.Color={fromBytes:function(e,t,n,s){return new T(e,t,n,null!=s?s:1)},fromRGB:function(e,t,n,s){return new B(e,t,n,null!=s?s:1)},fromHSV:function(e,t,n,s){return new U(e,t,n,null!=s?s:1)}}})(jQuery,parseInt)});